!function(){function n(){}var t="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this||{},e=t._,i=Array.prototype,s=Object.prototype,h="undefined"!=typeof Symbol?Symbol.prototype:null,r=i.push,u=i.slice,f=s.toString,o=s.hasOwnProperty,a=Array.isArray,c=Object.keys,l=Object.create,d=function(t){return t instanceof d?t:this instanceof d?void(this._wrapped=t):new d(t)};"undefined"==typeof exports||exports.nodeType?t._=d:("undefined"!=typeof module&&!module.nodeType&&module.exports&&(exports=module.exports=d),exports._=d),d.VERSION="1.9.1";function p(r,o,t){if(void 0===o)return r;switch(null==t?3:t){case 1:return function(t){return r.call(o,t)};case 3:return function(t,e,n){return r.call(o,t,e,n)};case 4:return function(t,e,n,i){return r.call(o,t,e,n,i)}}return function(){return r.apply(o,arguments)}}function v(t,e,n){return d.iteratee!==g?d.iteratee(t,e):null==t?d.identity:d.isFunction(t)?p(t,e,n):d.isObject(t)&&!d.isArray(t)?d.matcher(t):d.property(t)}var g;d.iteratee=g=function(t,e){return v(t,e,1/0)};function y(r,o){return o=null==o?r.length-1:+o,function(){for(var t=Math.max(arguments.length-o,0),e=Array(t),n=0;n<t;n++)e[n]=arguments[n+o];switch(o){case 0:return r.call(this,e);case 1:return r.call(this,arguments[0],e);case 2:return r.call(this,arguments[0],arguments[1],e)}var i=Array(o+1);for(n=0;n<o;n++)i[n]=arguments[n];return i[o]=e,r.apply(this,i)}}function m(t){if(!d.isObject(t))return{};if(l)return l(t);n.prototype=t;var e=new n;return n.prototype=null,e}function b(e){return function(t){return null==t?void 0:t[e]}}function _(t,e){return null!=t&&o.call(t,e)}function x(t,e){for(var n=e.length,i=0;i<n;i++){if(null==t)return;t=t[e[i]]}return n?t:void 0}function w(t){var e=j(t);return"number"==typeof e&&0<=e&&e<=k}var k=Math.pow(2,53)-1,j=b("length");d.each=d.forEach=function(t,e,n){var i,r;if(e=p(e,n),w(t))for(i=0,r=t.length;i<r;i++)e(t[i],i,t);else{var o=d.keys(t);for(i=0,r=o.length;i<r;i++)e(t[o[i]],o[i],t)}return t},d.map=d.collect=function(t,e,n){e=v(e,n);for(var i=!w(t)&&d.keys(t),r=(i||t).length,o=Array(r),s=0;s<r;s++){var a=i?i[s]:s;o[s]=e(t[a],a,t)}return o};function O(u){return function(t,e,n,i){var r=3<=arguments.length;return function(t,e,n,i){var r=!w(t)&&d.keys(t),o=(r||t).length,s=0<u?0:o-1;for(i||(n=t[r?r[s]:s],s+=u);0<=s&&s<o;s+=u){var a=r?r[s]:s;n=e(n,t[a],a,t)}return n}(t,p(e,i,4),n,r)}}d.reduce=d.foldl=d.inject=O(1),d.reduceRight=d.foldr=O(-1),d.find=d.detect=function(t,e,n){var i=(w(t)?d.findIndex:d.findKey)(t,e,n);if(void 0!==i&&-1!==i)return t[i]},d.filter=d.select=function(t,i,e){var r=[];return i=v(i,e),d.each(t,function(t,e,n){i(t,e,n)&&r.push(t)}),r},d.reject=function(t,e,n){return d.filter(t,d.negate(v(e)),n)},d.every=d.all=function(t,e,n){e=v(e,n);for(var i=!w(t)&&d.keys(t),r=(i||t).length,o=0;o<r;o++){var s=i?i[o]:o;if(!e(t[s],s,t))return!1}return!0},d.some=d.any=function(t,e,n){e=v(e,n);for(var i=!w(t)&&d.keys(t),r=(i||t).length,o=0;o<r;o++){var s=i?i[o]:o;if(e(t[s],s,t))return!0}return!1},d.contains=d.includes=d.include=function(t,e,n,i){return w(t)||(t=d.values(t)),"number"==typeof n&&!i||(n=0),0<=d.indexOf(t,e,n)},d.invoke=y(function(t,n,i){var r,o;return d.isFunction(n)?o=n:d.isArray(n)&&(r=n.slice(0,-1),n=n[n.length-1]),d.map(t,function(t){var e=o;if(!e){if(r&&r.length&&(t=x(t,r)),null==t)return;e=t[n]}return null==e?e:e.apply(t,i)})}),d.pluck=function(t,e){return d.map(t,d.property(e))},d.where=function(t,e){return d.filter(t,d.matcher(e))},d.findWhere=function(t,e){return d.find(t,d.matcher(e))},d.max=function(t,i,e){var n,r,o=-1/0,s=-1/0;if(null==i||"number"==typeof i&&"object"!=typeof t[0]&&null!=t)for(var a=0,u=(t=w(t)?t:d.values(t)).length;a<u;a++)null!=(n=t[a])&&o<n&&(o=n);else i=v(i,e),d.each(t,function(t,e,n){r=i(t,e,n),(s<r||r===-1/0&&o===-1/0)&&(o=t,s=r)});return o},d.min=function(t,i,e){var n,r,o=1/0,s=1/0;if(null==i||"number"==typeof i&&"object"!=typeof t[0]&&null!=t)for(var a=0,u=(t=w(t)?t:d.values(t)).length;a<u;a++)null!=(n=t[a])&&n<o&&(o=n);else i=v(i,e),d.each(t,function(t,e,n){((r=i(t,e,n))<s||r===1/0&&o===1/0)&&(o=t,s=r)});return o},d.shuffle=function(t){return d.sample(t,1/0)},d.sample=function(t,e,n){if(null==e||n)return w(t)||(t=d.values(t)),t[d.random(t.length-1)];var i=w(t)?d.clone(t):d.values(t),r=j(i);e=Math.max(Math.min(e,r),0);for(var o=r-1,s=0;s<e;s++){var a=d.random(s,o),u=i[s];i[s]=i[a],i[a]=u}return i.slice(0,e)},d.sortBy=function(t,i,e){var r=0;return i=v(i,e),d.pluck(d.map(t,function(t,e,n){return{value:t,index:r++,criteria:i(t,e,n)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(i<n||void 0===n)return 1;if(n<i||void 0===i)return-1}return t.index-e.index}),"value")};function E(s,e){return function(i,r,t){var o=e?[[],[]]:{};return r=v(r,t),d.each(i,function(t,e){var n=r(t,e,i);s(o,t,n)}),o}}d.groupBy=E(function(t,e,n){_(t,n)?t[n].push(e):t[n]=[e]}),d.indexBy=E(function(t,e,n){t[n]=e}),d.countBy=E(function(t,e,n){_(t,n)?t[n]++:t[n]=1});var $=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;d.toArray=function(t){return t?d.isArray(t)?u.call(t):d.isString(t)?t.match($):w(t)?d.map(t,d.identity):d.values(t):[]},d.size=function(t){return null==t?0:w(t)?t.length:d.keys(t).length},d.partition=E(function(t,e,n){t[n?0:1].push(e)},!0),d.first=d.head=d.take=function(t,e,n){return null==t||t.length<1?null==e?void 0:[]:null==e||n?t[0]:d.initial(t,t.length-e)},d.initial=function(t,e,n){return u.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},d.last=function(t,e,n){return null==t||t.length<1?null==e?void 0:[]:null==e||n?t[t.length-1]:d.rest(t,Math.max(0,t.length-e))},d.rest=d.tail=d.drop=function(t,e,n){return u.call(t,null==e||n?1:e)},d.compact=function(t){return d.filter(t,Boolean)};var A=function(t,e,n,i){for(var r=(i=i||[]).length,o=0,s=j(t);o<s;o++){var a=t[o];if(w(a)&&(d.isArray(a)||d.isArguments(a)))if(e)for(var u=0,c=a.length;u<c;)i[r++]=a[u++];else A(a,e,n,i),r=i.length;else n||(i[r++]=a)}return i};d.flatten=function(t,e){return A(t,e,!1)},d.without=y(function(t,e){return d.difference(t,e)}),d.uniq=d.unique=function(t,e,n,i){d.isBoolean(e)||(i=n,n=e,e=!1),null!=n&&(n=v(n,i));for(var r=[],o=[],s=0,a=j(t);s<a;s++){var u=t[s],c=n?n(u,s,t):u;e&&!n?(s&&o===c||r.push(u),o=c):n?d.contains(o,c)||(o.push(c),r.push(u)):d.contains(r,u)||r.push(u)}return r},d.union=y(function(t){return d.uniq(A(t,!0,!0))}),d.intersection=function(t){for(var e=[],n=arguments.length,i=0,r=j(t);i<r;i++){var o=t[i];if(!d.contains(e,o)){var s;for(s=1;s<n&&d.contains(arguments[s],o);s++);s===n&&e.push(o)}}return e},d.difference=y(function(t,e){return e=A(e,!0,!0),d.filter(t,function(t){return!d.contains(e,t)})}),d.unzip=function(t){for(var e=t&&d.max(t,j).length||0,n=Array(e),i=0;i<e;i++)n[i]=d.pluck(t,i);return n},d.zip=y(d.unzip),d.object=function(t,e){for(var n={},i=0,r=j(t);i<r;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n};function S(o){return function(t,e,n){e=v(e,n);for(var i=j(t),r=0<o?0:i-1;0<=r&&r<i;r+=o)if(e(t[r],r,t))return r;return-1}}d.findIndex=S(1),d.findLastIndex=S(-1),d.sortedIndex=function(t,e,n,i){for(var r=(n=v(n,i,1))(e),o=0,s=j(t);o<s;){var a=Math.floor((o+s)/2);n(t[a])<r?o=a+1:s=a}return o};function T(o,s,a){return function(t,e,n){var i=0,r=j(t);if("number"==typeof n)0<o?i=0<=n?n:Math.max(n+r,i):r=0<=n?Math.min(n+1,r):n+r+1;else if(a&&n&&r)return t[n=a(t,e)]===e?n:-1;if(e!=e)return 0<=(n=s(u.call(t,i,r),d.isNaN))?n+i:-1;for(n=0<o?i:r-1;0<=n&&n<r;n+=o)if(t[n]===e)return n;return-1}}d.indexOf=T(1,d.findIndex,d.sortedIndex),d.lastIndexOf=T(-1,d.findLastIndex),d.range=function(t,e,n){null==e&&(e=t||0,t=0),n=n||(e<t?-1:1);for(var i=Math.max(Math.ceil((e-t)/n),0),r=Array(i),o=0;o<i;o++,t+=n)r[o]=t;return r},d.chunk=function(t,e){if(null==e||e<1)return[];for(var n=[],i=0,r=t.length;i<r;)n.push(u.call(t,i,i+=e));return n};function I(t,e,n,i,r){if(!(i instanceof e))return t.apply(n,r);var o=m(t.prototype),s=t.apply(o,r);return d.isObject(s)?s:o}d.bind=y(function(e,n,i){if(!d.isFunction(e))throw new TypeError("Bind must be called on a function");var r=y(function(t){return I(e,r,n,this,i.concat(t))});return r}),d.partial=y(function(r,o){var s=d.partial.placeholder,a=function(){for(var t=0,e=o.length,n=Array(e),i=0;i<e;i++)n[i]=o[i]===s?arguments[t++]:o[i];for(;t<arguments.length;)n.push(arguments[t++]);return I(r,a,this,this,n)};return a}),(d.partial.placeholder=d).bindAll=y(function(t,e){var n=(e=A(e,!1,!1)).length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var i=e[n];t[i]=d.bind(t[i],t)}}),d.memoize=function(i,r){var o=function(t){var e=o.cache,n=""+(r?r.apply(this,arguments):t);return _(e,n)||(e[n]=i.apply(this,arguments)),e[n]};return o.cache={},o},d.delay=y(function(t,e,n){return setTimeout(function(){return t.apply(null,n)},e)}),d.defer=d.partial(d.delay,d,1),d.throttle=function(n,i,r){var o,s,a,u,c=0;r=r||{};function l(){c=!1===r.leading?0:d.now(),o=null,u=n.apply(s,a),o||(s=a=null)}function t(){var t=d.now();c||!1!==r.leading||(c=t);var e=i-(t-c);return s=this,a=arguments,e<=0||i<e?(o&&(clearTimeout(o),o=null),c=t,u=n.apply(s,a),o||(s=a=null)):o||!1===r.trailing||(o=setTimeout(l,e)),u}return t.cancel=function(){clearTimeout(o),c=0,o=s=a=null},t},d.debounce=function(n,i,r){function o(t,e){s=null,e&&(a=n.apply(t,e))}var s,a,t=y(function(t){if(s&&clearTimeout(s),r){var e=!s;s=setTimeout(o,i),e&&(a=n.apply(this,t))}else s=d.delay(o,i,this,t);return a});return t.cancel=function(){clearTimeout(s),s=null},t},d.wrap=function(t,e){return d.partial(e,t)},d.negate=function(t){return function(){return!t.apply(this,arguments)}},d.compose=function(){var n=arguments,i=n.length-1;return function(){for(var t=i,e=n[i].apply(this,arguments);t--;)e=n[t].call(this,e);return e}},d.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},d.before=function(t,e){var n;return function(){return 0<--t&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}},d.once=d.partial(d.before,2),d.restArguments=y;function M(t,e){var n=C.length,i=t.constructor,r=d.isFunction(i)&&i.prototype||s,o="constructor";for(_(t,o)&&!d.contains(e,o)&&e.push(o);n--;)(o=C[n])in t&&t[o]!==r[o]&&!d.contains(e,o)&&e.push(o)}var N=!{toString:null}.propertyIsEnumerable("toString"),C=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];d.keys=function(t){if(!d.isObject(t))return[];if(c)return c(t);var e=[];for(var n in t)_(t,n)&&e.push(n);return N&&M(t,e),e},d.allKeys=function(t){if(!d.isObject(t))return[];var e=[];for(var n in t)e.push(n);return N&&M(t,e),e},d.values=function(t){for(var e=d.keys(t),n=e.length,i=Array(n),r=0;r<n;r++)i[r]=t[e[r]];return i},d.mapObject=function(t,e,n){e=v(e,n);for(var i=d.keys(t),r=i.length,o={},s=0;s<r;s++){var a=i[s];o[a]=e(t[a],a,t)}return o},d.pairs=function(t){for(var e=d.keys(t),n=e.length,i=Array(n),r=0;r<n;r++)i[r]=[e[r],t[e[r]]];return i},d.invert=function(t){for(var e={},n=d.keys(t),i=0,r=n.length;i<r;i++)e[t[n[i]]]=n[i];return e},d.functions=d.methods=function(t){var e=[];for(var n in t)d.isFunction(t[n])&&e.push(n);return e.sort()};function z(u,c){return function(t){var e=arguments.length;if(c&&(t=Object(t)),e<2||null==t)return t;for(var n=1;n<e;n++)for(var i=arguments[n],r=u(i),o=r.length,s=0;s<o;s++){var a=r[s];c&&void 0!==t[a]||(t[a]=i[a])}return t}}d.extend=z(d.allKeys),d.extendOwn=d.assign=z(d.keys),d.findKey=function(t,e,n){e=v(e,n);for(var i,r=d.keys(t),o=0,s=r.length;o<s;o++)if(e(t[i=r[o]],i,t))return i};function H(t,e,n){return e in n}var F,R;d.pick=y(function(t,e){var n={},i=e[0];if(null==t)return n;d.isFunction(i)?(1<e.length&&(i=p(i,e[1])),e=d.allKeys(t)):(i=H,e=A(e,!1,!1),t=Object(t));for(var r=0,o=e.length;r<o;r++){var s=e[r],a=t[s];i(a,s,t)&&(n[s]=a)}return n}),d.omit=y(function(t,n){var e,i=n[0];return d.isFunction(i)?(i=d.negate(i),1<n.length&&(e=n[1])):(n=d.map(A(n,!1,!1),String),i=function(t,e){return!d.contains(n,e)}),d.pick(t,i,e)}),d.defaults=z(d.allKeys,!0),d.create=function(t,e){var n=m(t);return e&&d.extendOwn(n,e),n},d.clone=function(t){return d.isObject(t)?d.isArray(t)?t.slice():d.extend({},t):t},d.tap=function(t,e){return e(t),t},d.isMatch=function(t,e){var n=d.keys(e),i=n.length;if(null==t)return!i;for(var r=Object(t),o=0;o<i;o++){var s=n[o];if(e[s]!==r[s]||!(s in r))return!1}return!0},F=function(t,e,n,i){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var r=typeof t;return("function"==r||"object"==r||"object"==typeof e)&&R(t,e,n,i)},R=function(t,e,n,i){t instanceof d&&(t=t._wrapped),e instanceof d&&(e=e._wrapped);var r=f.call(t);if(r!==f.call(e))return!1;switch(r){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object Symbol]":return h.valueOf.call(t)===h.valueOf.call(e)}var o="[object Array]"===r;if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var s=t.constructor,a=e.constructor;if(s!==a&&!(d.isFunction(s)&&s instanceof s&&d.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1}i=i||[];for(var u=(n=n||[]).length;u--;)if(n[u]===t)return i[u]===e;if(n.push(t),i.push(e),o){if((u=t.length)!==e.length)return!1;for(;u--;)if(!F(t[u],e[u],n,i))return!1}else{var c,l=d.keys(t);if(u=l.length,d.keys(e).length!==u)return!1;for(;u--;)if(c=l[u],!_(e,c)||!F(t[c],e[c],n,i))return!1}return n.pop(),i.pop(),!0},d.isEqual=function(t,e){return F(t,e)},d.isEmpty=function(t){return null==t||(w(t)&&(d.isArray(t)||d.isString(t)||d.isArguments(t))?0===t.length:0===d.keys(t).length)},d.isElement=function(t){return!(!t||1!==t.nodeType)},d.isArray=a||function(t){return"[object Array]"===f.call(t)},d.isObject=function(t){var e=typeof t;return"function"==e||"object"==e&&!!t},d.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(e){d["is"+e]=function(t){return f.call(t)==="[object "+e+"]"}}),d.isArguments(arguments)||(d.isArguments=function(t){return _(t,"callee")});var P=t.document&&t.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof P&&(d.isFunction=function(t){return"function"==typeof t||!1}),d.isFinite=function(t){return!d.isSymbol(t)&&isFinite(t)&&!isNaN(parseFloat(t))},d.isNaN=function(t){return d.isNumber(t)&&isNaN(t)},d.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===f.call(t)},d.isNull=function(t){return null===t},d.isUndefined=function(t){return void 0===t},d.has=function(t,e){if(!d.isArray(e))return _(t,e);for(var n=e.length,i=0;i<n;i++){var r=e[i];if(null==t||!o.call(t,r))return!1;t=t[r]}return!!n},d.noConflict=function(){return t._=e,this},d.identity=function(t){return t},d.constant=function(t){return function(){return t}},d.noop=function(){},d.property=function(e){return d.isArray(e)?function(t){return x(t,e)}:b(e)},d.propertyOf=function(e){return null==e?function(){}:function(t){return d.isArray(t)?x(e,t):e[t]}},d.matcher=d.matches=function(e){return e=d.extendOwn({},e),function(t){return d.isMatch(t,e)}},d.times=function(t,e,n){var i=Array(Math.max(0,t));e=p(e,n,1);for(var r=0;r<t;r++)i[r]=e(r);return i},d.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},d.now=Date.now||function(){return(new Date).getTime()};function q(e){function n(t){return e[t]}var t="(?:"+d.keys(e).join("|")+")",i=RegExp(t),r=RegExp(t,"g");return function(t){return t=null==t?"":""+t,i.test(t)?t.replace(r,n):t}}var B={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},U=d.invert(B);d.escape=q(B),d.unescape=q(U),d.result=function(t,e,n){d.isArray(e)||(e=[e]);var i=e.length;if(!i)return d.isFunction(n)?n.call(t):n;for(var r=0;r<i;r++){var o=null==t?void 0:t[e[r]];void 0===o&&(o=n,r=i),t=d.isFunction(o)?o.call(t):o}return t};var D=0;d.uniqueId=function(t){var e=++D+"";return t?t+e:e},d.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};function L(t){return"\\"+K[t]}var J=/(.)^/,K={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},W=/\\|'|\r|\n|\u2028|\u2029/g;d.template=function(o,t,e){!t&&e&&(t=e),t=d.defaults({},t,d.templateSettings);var n,i=RegExp([(t.escape||J).source,(t.interpolate||J).source,(t.evaluate||J).source].join("|")+"|$","g"),s=0,a="__p+='";o.replace(i,function(t,e,n,i,r){return a+=o.slice(s,r).replace(W,L),s=r+t.length,e?a+="'+\n((__t=("+e+"))==null?'':_.escape(__t))+\n'":n?a+="'+\n((__t=("+n+"))==null?'':__t)+\n'":i&&(a+="';\n"+i+"\n__p+='"),t}),a+="';\n",t.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{n=new Function(t.variable||"obj","_",a)}catch(t){throw t.source=a,t}function r(t){return n.call(this,t,d)}var u=t.variable||"obj";return r.source="function("+u+"){\n"+a+"}",r},d.chain=function(t){var e=d(t);return e._chain=!0,e};function X(t,e){return t._chain?d(e).chain():e}d.mixin=function(n){return d.each(d.functions(n),function(t){var e=d[t]=n[t];d.prototype[t]=function(){var t=[this._wrapped];return r.apply(t,arguments),X(this,e.apply(d,t))}}),d},d.mixin(d),d.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var n=i[e];d.prototype[e]=function(){var t=this._wrapped;return n.apply(t,arguments),"shift"!==e&&"splice"!==e||0!==t.length||delete t[0],X(this,t)}}),d.each(["concat","join","slice"],function(t){var e=i[t];d.prototype[t]=function(){return X(this,e.apply(this._wrapped,arguments))}}),d.prototype.value=function(){return this._wrapped},d.prototype.valueOf=d.prototype.toJSON=d.prototype.value,d.prototype.toString=function(){return String(this._wrapped)},"function"==typeof define&&define.amd&&define("underscore",[],function(){return d})}(),function(i,r){if("function"==typeof define&&define.amd)define("backbone",["underscore","jquery","exports"],function(t,e,n){i.Backbone=r(i,n,t,e)});else if("undefined"!=typeof exports){var t=require("underscore");r(i,exports,t)}else i.Backbone=r(i,{},i._,i.jQuery||i.Zepto||i.ender||i.$)}(this,function(t,a,w,e){var n=t.Backbone,i=[],r=i.slice;a.VERSION="1.1.2",a.$=e,a.noConflict=function(){return t.Backbone=n,this},a.emulateHTTP=!1,a.emulateJSON=!1;var o=a.Events={on:function(t,e,n){return h(this,"on",t,[e,n])&&e&&(this._events||(this._events={}),(this._events[t]||(this._events[t]=[])).push({callback:e,context:n,ctx:n||this})),this},once:function(t,e,n){if(!h(this,"once",t,[e,n])||!e)return this;var i=this,r=w.once(function(){i.off(t,r),e.apply(this,arguments)});return r._callback=e,this.on(t,r,n)},off:function(t,e,n){var i,r,o,s,a,u,c,l;if(!this._events||!h(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._events=void 0,this;for(a=0,u=(s=t?[t]:w.keys(this._events)).length;a<u;a++)if(t=s[a],o=this._events[t]){if(this._events[t]=i=[],e||n)for(c=0,l=o.length;c<l;c++)r=o[c],(e&&e!==r.callback&&e!==r.callback._callback||n&&n!==r.context)&&i.push(r);i.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=r.call(arguments,1);if(!h(this,"trigger",t,e))return this;var n=this._events[t],i=this._events.all;return n&&s(n,e),i&&s(i,arguments),this},stopListening:function(t,e,n){var i=this._listeningTo;if(!i)return this;var r=!e&&!n;for(var o in n||"object"!=typeof e||(n=this),t&&((i={})[t._listenId]=t),i)(t=i[o]).off(e,n,this),(r||w.isEmpty(t._events))&&delete this._listeningTo[o];return this}},u=/\s+/,h=function(t,e,n,i){if(!n)return!0;if("object"==typeof n){for(var r in n)t[e].apply(t,[r,n[r]].concat(i));return!1}if(u.test(n)){for(var o=n.split(u),s=0,a=o.length;s<a;s++)t[e].apply(t,[o[s]].concat(i));return!1}return!0},s=function(t,e){var n,i=-1,r=t.length,o=e[0],s=e[1],a=e[2];switch(e.length){case 0:for(;++i<r;)(n=t[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o);return;case 2:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o,s);return;case 3:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o,s,a);return;default:for(;++i<r;)(n=t[i]).callback.apply(n.ctx,e);return}};w.each({listenTo:"on",listenToOnce:"once"},function(r,t){o[t]=function(t,e,n){var i=this._listeningTo||(this._listeningTo={});return n||"object"!=typeof e||(n=this),(i[t._listenId||(t._listenId=w.uniqueId("l"))]=t)[r](e,n,this),this}}),o.bind=o.on,o.unbind=o.off,w.extend(a,o);var k=a.Model=function(t,e){var n=t||{};e=e||{},this.cid=w.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(n=this.parse(n,e)||{}),n=w.defaults({},n,w.result(this,"defaults")),this.set(n,e),this.changed={},this.initialize.apply(this,arguments)};w.extend(k.prototype,o,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(t){return w.clone(this.attributes)},sync:function(){return a.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return w.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,n){var i,r,o,s,a,u,c,l;if(null==t)return this;if("object"==typeof t?(r=t,n=e):(r={})[t]=e,n=n||{},!this._validate(r,n))return!1;for(i in o=n.unset,a=n.silent,s=[],u=this._changing,this._changing=!0,u||(this._previousAttributes=w.clone(this.attributes),this.changed={}),l=this.attributes,c=this._previousAttributes,this.idAttribute in r&&(this.id=r[this.idAttribute]),r)e=r[i],w.isEqual(l[i],e)||s.push(i),w.isEqual(c[i],e)?delete this.changed[i]:this.changed[i]=e,o?delete l[i]:l[i]=e;if(!a){s.length&&(this._pending=n);for(var h=0,f=s.length;h<f;h++)this.trigger("change:"+s[h],this,l[s[h]],n)}if(u)return this;if(!a)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,w.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var n in this.attributes)e[n]=void 0;return this.set(e,w.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!w.isEmpty(this.changed):w.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&w.clone(this.changed);var e,n=!1,i=this._changing?this._previousAttributes:this.attributes;for(var r in t)w.isEqual(i[r],e=t[r])||((n=n||{})[r]=e);return n},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return w.clone(this._previousAttributes)},fetch:function(e){void 0===(e=e?w.clone(e):{}).parse&&(e.parse=!0);var n=this,i=e.success;return e.success=function(t){if(!n.set(n.parse(t,e),e))return!1;i&&i(n,t,e),n.trigger("sync",n,t,e)},M(this,e),this.sync("read",this,e)},save:function(t,e,n){var i,r,o,s=this.attributes;if(null==t||"object"==typeof t?(i=t,n=e):(i={})[t]=e,n=w.extend({validate:!0},n),i&&!n.wait){if(!this.set(i,n))return!1}else if(!this._validate(i,n))return!1;i&&n.wait&&(this.attributes=w.extend({},s,i)),void 0===n.parse&&(n.parse=!0);var a=this,u=n.success;return n.success=function(t){a.attributes=s;var e=a.parse(t,n);if(n.wait&&(e=w.extend(i||{},e)),w.isObject(e)&&!a.set(e,n))return!1;u&&u(a,t,n),a.trigger("sync",a,t,n)},M(this,n),"patch"==(r=this.isNew()?"create":n.patch?"patch":"update")&&(n.attrs=i),o=this.sync(r,this,n),i&&n.wait&&(this.attributes=s),o},destroy:function(e){e=e?w.clone(e):{};function n(){i.trigger("destroy",i,i.collection,e)}var i=this,r=e.success;if(e.success=function(t){(e.wait||i.isNew())&&n(),r&&r(i,t,e),i.isNew()||i.trigger("sync",i,t,e)},this.isNew())return e.success(),!1;M(this,e);var t=this.sync("delete",this,e);return e.wait||n(),t},url:function(){var t=w.result(this,"urlRoot")||w.result(this.collection,"url")||I();return this.isNew()?t:t.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},w.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=w.extend({},this.attributes,t);var n=this.validationError=this.validate(t,e)||null;return!n||(this.trigger("invalid",this,n,w.extend(e,{validationError:n})),!1)}});w.each(["keys","values","pairs","invert","pick","omit"],function(e){k.prototype[e]=function(){var t=r.call(arguments);return t.unshift(this.attributes),w[e].apply(w,t)}});var c=a.Collection=function(t,e){(e=e||{}).model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,w.extend({silent:!0},e))},j={add:!0,remove:!0,merge:!0},l={add:!0,remove:!1};w.extend(c.prototype,o,{model:k,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return a.sync.apply(this,arguments)},add:function(t,e){return this.set(t,w.extend({merge:!1},e,l))},remove:function(t,e){var n,i,r,o,s=!w.isArray(t);for(e=e||{},n=0,i=(t=s?[t]:w.clone(t)).length;n<i;n++)(o=t[n]=this.get(t[n]))&&(delete this._byId[o.id],delete this._byId[o.cid],r=this.indexOf(o),this.models.splice(r,1),this.length--,e.silent||(e.index=r,o.trigger("remove",o,this,e)),this._removeReference(o,e));return s?t[0]:t},set:function(t,e){(e=w.defaults({},e,j)).parse&&(t=this.parse(t,e));var n,i,r,o,s,a,u,c=!w.isArray(t);t=c?t?[t]:[]:w.clone(t);var l=e.at,h=this.model,f=this.comparator&&null==l&&!1!==e.sort,d=w.isString(this.comparator)?this.comparator:null,p=[],v=[],g={},y=e.add,m=e.merge,b=e.remove,_=!(f||!y||!b)&&[];for(n=0,i=t.length;n<i;n++){if(r=(s=t[n]||{})instanceof k?o=s:s[h.prototype.idAttribute||"id"],a=this.get(r))b&&(g[a.cid]=!0),m&&(s=s===o?o.attributes:s,e.parse&&(s=a.parse(s,e)),a.set(s,e),f&&!u&&a.hasChanged(d)&&(u=!0)),t[n]=a;else if(y){if(!(o=t[n]=this._prepareModel(s,e)))continue;p.push(o),this._addReference(o,e)}o=a||o,!_||!o.isNew()&&g[o.id]||_.push(o),g[o.id]=!0}if(b){for(n=0,i=this.length;n<i;++n)g[(o=this.models[n]).cid]||v.push(o);v.length&&this.remove(v,e)}if(p.length||_&&_.length)if(f&&(u=!0),this.length+=p.length,null!=l)for(n=0,i=p.length;n<i;n++)this.models.splice(l+n,0,p[n]);else{_&&(this.models.length=0);var x=_||p;for(n=0,i=x.length;n<i;n++)this.models.push(x[n])}if(u&&this.sort({silent:!0}),!e.silent){for(n=0,i=p.length;n<i;n++)(o=p[n]).trigger("add",o,this,e);(u||_&&_.length)&&this.trigger("sort",this,e)}return c?t[0]:t},reset:function(t,e){e=e||{};for(var n=0,i=this.models.length;n<i;n++)this._removeReference(this.models[n],e);return e.previousModels=this.models,this._reset(),t=this.add(t,w.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,w.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,w.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return r.apply(this.models,arguments)},get:function(t){if(null!=t)return this._byId[t]||this._byId[t.id]||this._byId[t.cid]},at:function(t){return this.models[t]},where:function(n,t){return w.isEmpty(n)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var e in n)if(n[e]!==t.get(e))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t=t||{},w.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(w.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return w.invoke(this.models,"get",t)},fetch:function(n){void 0===(n=n?w.clone(n):{}).parse&&(n.parse=!0);var i=n.success,r=this;return n.success=function(t){var e=n.reset?"reset":"set";r[e](t,n),i&&i(r,t,n),r.trigger("sync",r,t,n)},M(this,n),this.sync("read",this,n)},create:function(t,n){if(n=n?w.clone(n):{},!(t=this._prepareModel(t,n)))return!1;n.wait||this.add(t,n);var i=this,r=n.success;return n.success=function(t,e){n.wait&&i.add(t,n),r&&r(t,e,n)},t.save(null,n),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof k)return t;var n=new(((e=e?w.clone(e):{}).collection=this).model)(t,e);return n.validationError?(this.trigger("invalid",this,n.validationError,e),!1):n},_addReference:function(t,e){null!=(this._byId[t.cid]=t).id&&(this._byId[t.id]=t),t.collection||(t.collection=this),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,i){("add"!==t&&"remove"!==t||n===this)&&("destroy"===t&&this.remove(e,i),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});w.each(["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"],function(e){c.prototype[e]=function(){var t=r.call(arguments);return t.unshift(this.models),w[e].apply(w,t)}});w.each(["groupBy","countBy","sortBy","indexBy"],function(i){c.prototype[i]=function(e,t){var n=w.isFunction(e)?e:function(t){return t.get(e)};return w[i](this.models,n,t)}});var f=a.View=function(t){this.cid=w.uniqueId("view"),t=t||{},w.extend(this,w.pick(t,p)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},d=/^(\S+)\s*(.*)$/,p=["model","collection","el","id","attributes","className","tagName","events"];w.extend(f.prototype,o,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,e){return this.$el&&this.undelegateEvents(),this.$el=t instanceof a.$?t:a.$(t),this.el=this.$el[0],!1!==e&&this.delegateEvents(),this},delegateEvents:function(t){if(!(t=t||w.result(this,"events")))return this;for(var e in this.undelegateEvents(),t){var n=t[e];if(w.isFunction(n)||(n=this[t[e]]),n){var i=e.match(d),r=i[1],o=i[2];n=w.bind(n,this),r+=".delegateEvents"+this.cid,""===o?this.$el.on(r,n):this.$el.on(r,o,n)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(w.result(this,"el"),!1);else{var t=w.extend({},w.result(this,"attributes"));this.id&&(t.id=w.result(this,"id")),this.className&&(t.class=w.result(this,"className"));var e=a.$("<"+w.result(this,"tagName")+">").attr(t);this.setElement(e,!1)}}}),a.sync=function(t,e,n){var i=g[t];w.defaults(n=n||{},{emulateHTTP:a.emulateHTTP,emulateJSON:a.emulateJSON});var r={type:i,dataType:"json"};if(n.url||(r.url=w.result(e,"url")||I()),null!=n.data||!e||"create"!==t&&"update"!==t&&"patch"!==t||(r.contentType="application/json",r.data=JSON.stringify(n.attrs||e.toJSON(n))),n.emulateJSON&&(r.contentType="application/x-www-form-urlencoded",r.data=r.data?{model:r.data}:{}),n.emulateHTTP&&("PUT"===i||"DELETE"===i||"PATCH"===i)){r.type="POST",n.emulateJSON&&(r.data._method=i);var o=n.beforeSend;n.beforeSend=function(t){if(t.setRequestHeader("X-HTTP-Method-Override",i),o)return o.apply(this,arguments)}}"GET"===r.type||n.emulateJSON||(r.processData=!1),"PATCH"===r.type&&v&&(r.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var s=n.xhr=a.ajax(w.extend(r,n));return e.trigger("request",e,s,n),s};var v=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),g={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};a.ajax=function(){return a.$.ajax.apply(a.$,arguments)};var y=a.Router=function(t){(t=t||{}).routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},m=/\((.*?)\)/g,b=/(\(\?)?:\w+/g,_=/\*\w+/g,x=/[\-{}\[\]+?.,\\\^$|#\s]/g;w.extend(y.prototype,o,{initialize:function(){},route:function(n,i,r){w.isRegExp(n)||(n=this._routeToRegExp(n)),w.isFunction(i)&&(r=i,i=""),r=r||this[i];var o=this;return a.history.route(n,function(t){var e=o._extractParameters(n,t);o.execute(r,e),o.trigger.apply(o,["route:"+i].concat(e)),o.trigger("route",i,e),a.history.trigger("route",o,i,e)}),this},execute:function(t,e){t&&t.apply(this,e)},navigate:function(t,e){return a.history.navigate(t,e),this},_bindRoutes:function(){if(this.routes){this.routes=w.result(this,"routes");for(var t,e=w.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(x,"\\$&").replace(m,"(?:$1)?").replace(b,function(t,e){return e?t:"([^/?]+)"}).replace(_,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var n=t.exec(e).slice(1);return w.map(n,function(t,e){return e===n.length-1?t||null:t?decodeURIComponent(t):null})}});var O=a.History=function(){this.handlers=[],w.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},E=/^[#\/]|\s+$/g,$=/^\/+|\/+$/g,A=/msie [\w.]+/,S=/\/$/,T=/#.*$/;O.started=!1,w.extend(O.prototype,o,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=decodeURI(this.location.pathname+this.location.search);var n=this.root.replace(S,"");t.indexOf(n)||(t=t.slice(n.length))}else t=this.getHash();return t.replace(E,"")},start:function(t){if(O.started)throw new Error("Backbone.history has already been started");O.started=!0,this.options=w.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var e=this.getFragment(),n=document.documentMode,i=A.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);if(this.root=("/"+this.root+"/").replace($,"/"),i&&this._wantsHashChange){var r=a.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=r.hide().appendTo("body")[0].contentWindow,this.navigate(e)}this._hasPushState?a.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!i?a.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=e;var o=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&o.hash&&(this.fragment=this.getHash().replace(E,""),this.history.replaceState({},document.title,this.root+this.fragment))}if(!this.options.silent)return this.loadUrl()},stop:function(){a.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),O.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();if(e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment)return!1;this.iframe&&this.navigate(e),this.loadUrl()},loadUrl:function(e){return e=this.fragment=this.getFragment(e),w.any(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0})},navigate:function(t,e){if(!O.started)return!1;e&&!0!==e||(e={trigger:!!e});var n=this.root+(t=this.getFragment(t||""));if(t=t.replace(T,""),this.fragment!==t){if(""===(this.fragment=t)&&"/"!==n&&(n=n.slice(0,-1)),this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,n){if(n){var i=t.href.replace(/(javascript:|#).*$/,"");t.replace(i+"#"+e)}else t.hash="#"+e}}),a.history=new O;k.extend=c.extend=y.extend=f.extend=O.extend=function(t,e){var n,i=this;n=t&&w.has(t,"constructor")?t.constructor:function(){return i.apply(this,arguments)},w.extend(n,i,e);function r(){this.constructor=n}return r.prototype=i.prototype,n.prototype=new r,t&&w.extend(n.prototype,t),n.__super__=i.prototype,n};var I=function(){throw new Error('A "url" property or function must be specified')},M=function(e,n){var i=n.error;n.error=function(t){i&&i(e,t,n),e.trigger("error",e,t,n)}};return a}),function(t){define("noticeboard-code",["jquery"],function(){return function(){require(["jquery","backbone","underscore"],function(c,r,l){"use strict";r.emulateHTTP=!0,noticeboard.init=function(t){var e=r.Model.extend({url:function(){return this.collection.itemurl+"/"+this.id+"/json"}}),i=r.Collection.extend({initialize:function(){this.on("updateZIndex",this.updateZIndex),this.on("hide_edit",this.hideEdit),this.on("error",this.error)},model:e,error:function(t,e,n){423===e.status?alert("This note is currently being edited by another user!"):0===e.status||alert("An error occured! Errorcode: "+e.status+" Message: "+e.statusText)},updateZIndex:function(){l.each(l.sortBy(this.models,function(t){return t.get("zIndex")}),function(t,e){t.set({zIndex:e}),t.save()})},hideEdit:function(){this.each(function(t){t.get("show_edit")&&t.set({show_edit:0})})}}),n=r.View.extend({className:"boardnote",initialize:function(){this.model.bind("change",this.render,this),this.model.bind("destroy",this.remove,this),l.bindAll(this)},update:function(){this.model.fetch()},remove:function(){this.$el.remove()},updateZIndex:function(){var t=l.reduce(c(".boardnote"),function(t,e){return Math.max(c(e).zIndex(),t)},0);this.model.get("zIndex")!==t&&(this.model.set({zIndex:t+1}),1e3<1001*Math.random()||1e3<t?this.model.trigger("updateZIndex"):this.model.save())},updateEditBar:function(){this.model.trigger("hide_edit"),this.model.set({show_edit:1})},delete1:function(t){var e=this.model;return this.$el.find(".delete_confirm").effect("slide",{direction:"right"},function(){var t=c(this);t.find(".question, .not_confirm").click(function(){return e.trigger("hide_edit"),!1}),t.find(".confirm").click(function(){c(this).attr("href");e.destroy({wait:!0})})}),t.preventDefault(),!1},render:function(){var t,e={},o=this.model,n=this.model.get("color"),i=this.model.get("position_x"),r=this.model.get("position_y"),s=this.model.get("width"),a=this.model.get("height"),u=this.model.collection.note_template;return"25%"===i&&void 0!==this.model.collection.anon_new_position?(this.model.set({position_x:this.model.collection.anon_new_position.x,position_y:this.model.collection.anon_new_position.y}),this.model.save()):(c.extend(e,this.model.toJSON()),this.$el.unbind(),this.$el.empty(),this.$el.removeClass("ui-resizable"),this.$el.removeClass("ui-draggable"),this.$el.removeData(),this.$el.html(Mustache.render(u,e)),this.$el.zIndex(this.model.get("zIndex")),this.model.get("show_edit")&&this.$el.find(".actions_first").show(),this.$el.css("top",r),this.$el.css("left",i),this.$el.css("width",s),this.$el.css("height",a),this.$el.css("position","absolute"),this.model.get("old_color")&&this.$el.removeClass(this.model.get("old_color")),this.$el.addClass(n),this.repair_css(),this.fix_links(),this.$el.draggable({handle:"h3",containment:"window",cursor:"move",stack:".boardnote",stop:function(t,e){o.set({position_x:e.position.left,position_y:e.position.top,zIndex:e.helper.zIndex()},{silent:!0}),o.save()}}),this.$el.data("draggable")&&(this.$el.data("draggable").position=this.$el.data("draggable").offset={top:r,left:r}),this.$el.resizable({minHeight:150,minWidth:100,autoHide:!0,stop:function(t,e){o.set({width:e.size.width,height:e.size.height},{silent:!0}),o.save()}}),this.$el.find(".change_color a").click(function(t){var e=["yellow","blue","green","pink","purple","lightblue","grey","beige"],n=o.get("color"),i=e.indexOf(n),r=e[(i+1)%e.length];t.preventDefault(),o.set({old_color:n}),o.set({color:r}),o.save()}),c.fn.prepOverlay&&this.$el.find(".deletex a").prepOverlay({subtype:"ajax",filter:"#content>*",noform:"close",formselector:"form#delete_confirmation",afterpost:l.bind(this.remove,this)}),c.fn.prepOverlay&&this.$el.find(".edit a").prepOverlay({subtype:"ajax",filter:"#content>*",formselector:"form[name=edit_form],form#form",noform:"close",afterpost:l.bind(this.update,this),config:{onLoad:function(t){var e,n;t.stopPropagation(),window.TinyMCEConfig?(e=new TinyMCEConfig("text")).init():(e=(n=t.currentTarget.getOverlay().find(".mce_editable")).data("mce-config"),n.tinymce(e)),t.currentTarget.getOverlay().find(".ArchetypesKeywordWidget select").multiSelect();try{copyDataForSubmit("form-widgets-display_types")}catch(t){}},onClose:function(){window.InitializedTinyMCEInstances&&delete InitializedTinyMCEInstances.text},closeOnClick:!1,fixed:!0,speed:"fast"}}),t=this.$el.find(".publish"),"published"===this.model.get("review_state")?t.hide():this.$el.find(".publish a").click(function(t){c(this);t.preventDefault(),c.post(this.href,function(){o.set({review_state:"published"})})}),this.$el.bind("click.zindex",this.updateZIndex),this.$el.bind("click.edit",this.updateEditBar),this.$el.find(".delete a").click(this.delete1)),this},repair_css:function(){var t=this.$el.innerHeight(),e=this.$el.find("h3").innerHeight();e&&this.$el.find(".notecontent").height((t-e)/t*100+"%")},fix_links:function(){this.$el.find(".notecontent a").attr("target","_blank")}});new(r.View.extend({el:t,events:{click:"addAnonymous"},initialize:function(){console.log("Noticeboard app started");var n,e=this.notes=new i;this.update;this.notes.url=this.$el.data("href"),this.notes.itemurl=this.$el.data("hrefitem"),this.notes.bind("add",this.addOne,this),this.notes.bind("reset",this.reset,this),this.notes.bind("all",this.render,this),l.bindAll(this),c.fn.prepOverlay&&c(".add_note a").prepOverlay({subtype:"ajax",filter:"#content>*",formselector:"form[name=edit_form],form#form",noform:"close",afterpost:this.update,config:{onLoad:function(t){var e;window.TinyMCEConfig?(e=new TinyMCEConfig("text")).init():(e=(n=t.currentTarget.getOverlay().find(".mce_editable")).data("mce-config"),n.tinymce(e)),t.currentTarget.getOverlay().find(".ArchetypesKeywordWidget select").multiSelect();try{copyDataForSubmit("form-widgets-display_types")}catch(t){}},onClose:function(){window.InitializedTinyMCEInstances&&delete InitializedTinyMCEInstances.text},closeOnClick:!1,fixed:!0,speed:"fast"}}),c.fn.prepOverlay&&c("#notesettings a").prepOverlay({subtype:"ajax",filter:"#content>*",formselector:"form",noform:"reload",config:{onLoad:function(t){try{copyDataForSubmit("form-widgets-display_types")}catch(t){}}}}),c.fn.prepOverlay&&c("#viewsettings a").prepOverlay({subtype:"ajax",filter:"#content>*"}),c.fn.prepOverlay&&c("#notes_archive a").prepOverlay({subtype:"ajax",filter:"#content>*"}),c.fn.prepOverlay&&c("#noticeboard-help a").prepOverlay({subtype:"ajax",filter:"#content>*"}),c.get(this.$el.data("notetemplatehref"),function(t){e.note_template=t,e.fetch()})},addOne:function(t){var e=new n({model:t});this.$el.append(e.render().el),e.repair_css()},addAnonymous:function(t){if("noticeboardcanvas"!==t.target.id)return!0;if("True"!==c(t.target).data("addanonymous"))return c(".actions_first:visible").hide(),!0;var e=c(".add_note a").attr("href"),n=this.update;t.pageX,t.pageY;this.notes.anon_new_position={x:t.pageX,y:t.pageY},c.get(e,function(t){var e=c(t).find("form[name=edit_form]");e.find("input[name=title]").val(c(".anonymoustitle").text()),c.get(e.attr("action")+"?"+e.serialize(),function(){n()})})},reset:function(){this.$el.empty(),this.notes.each(this.addOne,this)},update:function(){this.notes.fetch()}}))}})}.apply(t,arguments)})}(this),define("/home/gomez/dev/dipf-intranet/src-mrd/collective.noticeboard/src/collective/noticeboard/resources/init_noticeboard.js",["jquery"],function(t){"use strict";jQuery(function(t){console.log("Init noticeboard")})}),jQuery(function(t){require(["noticeboard-code"])});
//# sourceMappingURL=noticeboard-compiled.min.js.map